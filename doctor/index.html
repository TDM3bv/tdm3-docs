<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Doctar transaction request API | TDM3 Docs</title>
    <meta name="description" content="publieke documentatie TDM3 API&#39;s">
    <link rel="icon" href="/faviconCustom.ico">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <link rel="preload" href="/assets/css/0.styles.ac15293d.css" as="style"><link rel="preload" href="/assets/js/app.9f76a772.js" as="script"><link rel="preload" href="/assets/js/3.d0406f5b.js" as="script"><link rel="preload" href="/assets/js/15.7be21cdf.js" as="script"><link rel="preload" href="/assets/js/13.ed2af69a.js" as="script"><link rel="prefetch" href="/assets/js/10.fae33810.js"><link rel="prefetch" href="/assets/js/11.1edaec78.js"><link rel="prefetch" href="/assets/js/12.d0a58eb1.js"><link rel="prefetch" href="/assets/js/14.38db3ef3.js"><link rel="prefetch" href="/assets/js/16.33d59e69.js"><link rel="prefetch" href="/assets/js/17.0a085ca8.js"><link rel="prefetch" href="/assets/js/18.68464975.js"><link rel="prefetch" href="/assets/js/4.b9c76b12.js"><link rel="prefetch" href="/assets/js/5.cb95fee3.js"><link rel="prefetch" href="/assets/js/6.8214b042.js"><link rel="prefetch" href="/assets/js/7.b0ba4e6a.js"><link rel="prefetch" href="/assets/js/8.86d955ef.js"><link rel="prefetch" href="/assets/js/9.b88e2e17.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.97920b74.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ac15293d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">TDM3 Docs</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/nurse/" class="nav-link">Thuisverpleging</a></div><div class="nav-item"><a href="/doctor/" class="nav-link router-link-exact-active router-link-active">Huisartsen</a></div> <a href="https://github.com/tdm3cvba/tdm3-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/nurse/" class="nav-link">Thuisverpleging</a></div><div class="nav-item"><a href="/doctor/" class="nav-link router-link-exact-active router-link-active">Huisartsen</a></div> <a href="https://github.com/tdm3cvba/tdm3-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Huisartsen</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/" class="sidebar-link">Home</a></li><li><a href="/doctor/" class="active sidebar-link">Doctar transaction request API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doctor/#general-remarks" class="sidebar-link">General remarks</a></li><li class="sidebar-sub-header"><a href="/doctor/#sequence" class="sidebar-link">Sequence</a></li><li class="sidebar-sub-header"><a href="/doctor/#the-api" class="sidebar-link">The API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doctor/#what-do-you-need-to-integrate" class="sidebar-link">What do you need to integrate?</a></li><li class="sidebar-sub-header"><a href="/doctor/#how-does-the-api-behave" class="sidebar-link">How does the API behave?</a></li><li class="sidebar-sub-header"><a href="/doctor/#request-examples" class="sidebar-link">Request examples</a></li></ul></li><li class="sidebar-sub-header"><a href="/doctor/#demo-app" class="sidebar-link">Demo App</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doctor/#example-code" class="sidebar-link">Example code</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Thuisverpleging</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="doctar-transaction-request-api"><a href="#doctar-transaction-request-api" class="header-anchor">#</a> Doctar transaction request API</h1> <h2 id="general-remarks"><a href="#general-remarks" class="header-anchor">#</a> General remarks</h2> <ul><li>The API has one endpoint and allows for an <strong>easy</strong> integration between EMD and Doctar with the purpose of <strong>easy</strong> entry of performances by a general practitioner.</li> <li>If you want to support use cases not supported or described below, please contact us.</li> <li>The API is a REST API, based on <a href="https://swagger.io/specification/" target="_blank" rel="noopener noreferrer">Open API 3.0<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.
<ul><li>The specification format allows for generation of client-side code in all common languages.</li></ul></li> <li>The specification (QUA environment) can be found <a href="https://qua-doctarwebtool.azurewebsites.net/Mederi/Doctar.Api/swagger/index.html?urls.primaryName=Public%2FV1" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://launch.smarthealthit.org/ehr.html?app=https%3A%2F%2Ftdm3cvba.github.io%2Fbb-clear-smart-fhir%2Flaunch.html%3Flaunch%3DeyJhIjoiMSIsImYiOiIxIn0%26iss%3Dhttps%253A%252F%252Flaunch.smarthealthit.org%252Fv%252Fr4%252Ffhir&amp;user=" target="_blank" rel="noopener noreferrer">Demo app<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="sequence"><a href="#sequence" class="header-anchor">#</a> Sequence</h2> <div class="mermaid">
sequenceDiagram
    participant ClientApp
    participant Doctar API
    participant User
    participant Doctar Webclient
    ClientApp-&gt;&gt;Doctar API:REQUEST: transaction (data)
    Doctar API -&gt;&gt;ClientApp: RESPONSE:201 Created + Links[certificate_webflow,..]
    ClientApp-&gt;&gt;User:Forward User to certificate_webflow link
        alt Authentication
        User-&gt;&gt;Doctar Webclient: Authentication
    end
        alt Forward user
        User-&gt;&gt;Doctar Webclient: complete+confirm transaction
    end
</div> <ol><li>ClientApp sends data to the API endpoint.</li> <li>Server responds with a 201 Created and a collection of links</li> <li>ClientApp forwards user to the certificate_webflow link (absolute url)</li> <li>(User authenticates on Doctar app)</li> <li>User completes + confirms the transaction form</li></ol> <p>You can see this flow in the gif below. The user has already authenticated.
<img src="https://github.com/TDM3cvba/bb-clear-smart-fhir/raw/master/bb-clear-smart-fhir-demo.gif" alt="Demo"></p> <p>The current use case of the Doctar transaction request API assumes no delegated authorization flow between clientapp (server) and the Doctar API. The JWT token is to track, identify and authorize the vendor. The user is authenticated and authorized when he/she gets forwarded to the webclient.
There are other (security) scenarios possible, but this is the easiest and simplest one.</p> <h2 id="the-api"><a href="#the-api" class="header-anchor">#</a> The API</h2> <h3 id="what-do-you-need-to-integrate"><a href="#what-do-you-need-to-integrate" class="header-anchor">#</a> What do you need to integrate?</h3> <ul><li>A JWT token for QUA</li> <li>A JWT token for PROD</li> <li>The endpoint to QUA</li> <li>The endpoint to PROD</li> <li>Be able to forward the user to a specific url on the user-default webbrowser (Chrome, Firefox, etc)</li></ul> <h3 id="how-does-the-api-behave"><a href="#how-does-the-api-behave" class="header-anchor">#</a> How does the API behave?</h3> <ul><li>The API requires as little data as possible to furfill its purpose</li> <li>Certain fields are necassary to facilitate a better user experience. Meaning, if the ClientApp sends a valid and complete request, the user needs to enter less him or herself</li> <li>We don't validate the request, except on being technically correct, which is the best kind of correct.</li> <li>If you set the x-validate HTTP header on &quot;true&quot;, you can trigger an extended validation.
<ul><li>This is usefull during development</li> <li>If the vendor wants to develop screens to show validation errors in the EMD app itself, but this requires more integration work</li> <li>This validation will change over time as the Doctar App will require less and less information from the ClientApp for certain types of use cases as more and more mycarenet webservices are supported natively in the Doctar App itself (invoicing to Mutuality vs ...)</li></ul></li> <li>The clientApp can send performance data, or let the user enter it in the Doctar webclient itself
<ul><li>We only require nomenclature codes, all complexity regarding pricing and tarification is handled by the Doctar webclient</li></ul></li></ul> <h3 id="request-examples"><a href="#request-examples" class="header-anchor">#</a> Request examples</h3> <div class="admonition example"><p class="admonition-title">TODO: explain the following request examples</p> <ul><li>[ ] standard request</li> <li>[ ] minimal request</li> <li>[ ] request with performances</li> <li>[ ] request with payer</li></ul></div> <h2 id="demo-app"><a href="#demo-app" class="header-anchor">#</a> Demo App</h2> <p>To demonstrate the API we developed a demo app. This demo app is forked from <a href="https://github.com/stfnh/bb-clear-smart-fhir" target="_blank" rel="noopener noreferrer">stfnh/bb-clear-smart-fhir<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> repo. Its purpose is to demonstrate the flow described above. The modified source code can be found on <a href="https://github.com/TDM3cvba/bb-clear-smart-fhir" target="_blank" rel="noopener noreferrer">TDM3cvba/bb-clear-smart-fhir<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>The app runs using SMART App Launcher</p> <p>Click <a href="http://launch.smarthealthit.org/ehr.html?app=https%3A%2F%2Ftdm3cvba.github.io%2Fbb-clear-smart-fhir%2Flaunch.html%3Flaunch%3DeyJhIjoiMSIsImYiOiIxIn0%26iss%3Dhttps%253A%252F%252Flaunch.smarthealthit.org%252Fv%252Fr4%252Ffhir&amp;user=" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for a direct link or follow the steps below</p> <ol><li>Go to <a href="http://launch.smarthealthit.org/" target="_blank" rel="noopener noreferrer">http://launch.smarthealthit.org/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Leave all settings as they are (FHIR Version R4).</li> <li>At the bottom of the page, set the App Launch Url to: <code>https://tdm3cvba.github.io/bb-clear-smart-fhir/launch.html</code></li> <li>Click <code>Launch App</code></li> <li>Login as practitioner</li> <li>Select a patient</li> <li>You will see the SMART on FHIR app populated with data from the Sandbox / Electronic Health Record system!</li></ol> <ul><li>The app is built with <a href="https://vuejs.org/" target="_blank" rel="noopener noreferrer">Vue.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and hosted on GitHub Pages</li></ul> <h3 id="example-code"><a href="#example-code" class="header-anchor">#</a> Example code</h3> <p>Sample code, which implements the client side code in javascript.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> jwtToken <span class="token operator">=</span> <span class="token string">'[JWT TOKEN HERE]'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> endpoint <span class="token operator">=</span> <span class="token string">'https://[BASE_ENDPOINT]'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> doctarClient <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  baseURL<span class="token punctuation">:</span>
    endpoint<span class="token punctuation">,</span>
  headers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    Authorization<span class="token punctuation">:</span>
     <span class="token string">'Bearer '</span> <span class="token operator">+</span> jwtToken
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span><span class="token operator">...</span><span class="token operator">...</span><span class="token punctuation">]</span>

<span class="token function-variable function">transactionRequest</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">encounter</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> mywindow <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//we open the window on the UI thread, during the user click event, </span>
      <span class="token comment">//so the browser doesn't block it as a popup</span>
      <span class="token comment">//other solution is to make the request fully synchronous     </span>
      <span class="token keyword">var</span> homeAddress <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>patient<span class="token punctuation">.</span>address<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> careDate <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> performances <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>encounter <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> encounter<span class="token punctuation">.</span>period <span class="token operator">!=</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        careDate <span class="token operator">=</span> encounter<span class="token punctuation">.</span>period<span class="token punctuation">.</span>start<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//remove timezone</span>
        performances<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          nomenclatureCode <span class="token punctuation">:</span> <span class="token string">&quot;101076&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        performances<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          nomenclatureCode <span class="token punctuation">:</span> <span class="token string">&quot;101091&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">var</span> inss <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fakeInss<span class="token punctuation">;</span>
      <span class="token keyword">var</span> fakeProvince <span class="token operator">=</span> <span class="token string">&quot;Oost-Vlaanderen&quot;</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> fakeCountry <span class="token operator">=</span> <span class="token string">&quot;BE&quot;</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> fakeNihiiCareProvider <span class="token operator">=</span> <span class="token string">&quot;17385467004&quot;</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> gender <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

      <span class="token keyword">switch</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>patient<span class="token punctuation">.</span>gender<span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
          <span class="token keyword">case</span> <span class="token string">&quot;male&quot;</span><span class="token punctuation">:</span>
            gender <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
          <span class="token keyword">case</span> <span class="token string">&quot;female&quot;</span><span class="token punctuation">:</span>
            gender <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$doctarClient
        <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/certificates/transaction'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
          careDate<span class="token punctuation">:</span> careDate<span class="token punctuation">,</span>
          CareReceiver<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            Inss<span class="token punctuation">:</span> inss<span class="token punctuation">,</span>
            name<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>patient<span class="token punctuation">.</span>name<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>family<span class="token punctuation">,</span>
            firstName<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>patient<span class="token punctuation">.</span>name<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>given<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            birthDate<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>patient<span class="token punctuation">.</span>birthDate<span class="token punctuation">,</span>
            gender<span class="token punctuation">:</span> gender<span class="token punctuation">,</span>
            email<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>patient<span class="token punctuation">.</span>telecom
              <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">t</span> <span class="token operator">=&gt;</span> t<span class="token punctuation">.</span>system <span class="token operator">==</span> <span class="token string">'email'</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>value <span class="token operator">&amp;&amp;</span> e<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  <span class="token keyword">return</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            InsurabilitySituation<span class="token punctuation">:</span> <span class="token punctuation">{</span>
              CodeEntitled<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                ct1<span class="token punctuation">:</span> <span class="token string">'110'</span><span class="token punctuation">,</span>
                ct2<span class="token punctuation">:</span> <span class="token string">'110'</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              mutualityCode<span class="token punctuation">:</span> <span class="token string">&quot;105&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            address<span class="token punctuation">:</span> <span class="token punctuation">{</span>
              street<span class="token punctuation">:</span> homeAddress<span class="token punctuation">.</span>line<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              postalCode<span class="token punctuation">:</span> homeAddress<span class="token punctuation">.</span>postalCode<span class="token punctuation">,</span>
              city<span class="token punctuation">:</span> homeAddress<span class="token punctuation">.</span>city<span class="token punctuation">,</span>
              province<span class="token punctuation">:</span> fakeProvince<span class="token punctuation">,</span>
              country<span class="token punctuation">:</span> fakeCountry
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          PackageProvider<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> <span class="token string">'demo-fhir-emd'</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          CareProvider<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            Nihii<span class="token punctuation">:</span> fakeNihiiCareProvider
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          Performances<span class="token punctuation">:</span> performances
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> response<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> link <span class="token operator">=</span> data<span class="token punctuation">.</span>links<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">l</span> <span class="token operator">=&gt;</span> l<span class="token punctuation">.</span>rel <span class="token operator">==</span> <span class="token string">'certificate_webflow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          mywindow<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> link<span class="token punctuation">.</span>href<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">incompleteTransactionRequest</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">validate</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>validate <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
          <span class="token keyword">var</span> mywindow <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token punctuation">}</span>      
      <span class="token comment">//we open the window on the UI thread, during the user click event, </span>
      <span class="token comment">//so the browser doesn't block it as a popup</span>
      <span class="token comment">//other solution is to make the request fully synchronous     </span>
      <span class="token keyword">var</span> inss <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fakeInss<span class="token punctuation">;</span>
      <span class="token keyword">var</span> config <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>validate <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        config <span class="token operator">=</span> <span class="token punctuation">{</span>
          headers <span class="token punctuation">:</span> <span class="token punctuation">{</span>
              <span class="token string">'x-validate'</span><span class="token punctuation">:</span> <span class="token boolean">true</span>
          <span class="token punctuation">}</span>          
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> fakeNihiiCareProvider <span class="token operator">=</span> <span class="token string">&quot;17385467004&quot;</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> gender <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$doctarClient
        <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/certificates/transaction'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
          CareReceiver<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            Inss<span class="token punctuation">:</span> inss<span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          PackageProvider<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> <span class="token string">'demo-fhir-emd'</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          CareProvider<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            Nihii<span class="token punctuation">:</span> <span class="token string">&quot;invalidriziv&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> config<span class="token punctuation">)</span>

        
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> response<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> link <span class="token operator">=</span> data<span class="token punctuation">.</span>links<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">l</span> <span class="token operator">=&gt;</span> l<span class="token punctuation">.</span>rel <span class="token operator">==</span> <span class="token string">'certificate_webflow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          mywindow<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> link<span class="token punctuation">.</span>href<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">errorResponse</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          
          <span class="token keyword">this</span><span class="token punctuation">.</span>errorResponse <span class="token operator">=</span> errorResponse<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
          
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/tdm3cvba/tdm3-docs/edit/master/docs/doctor/README.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/17/2019, 1:22:22 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/" class="prev router-link-active">Home</a></span> <span class="next"><a href="/nurse/">Beschrijving batch XML</a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><div class="reading-progress top" data-v-56679cca><div class="progress" data-v-56679cca></div></div><SWUpdatePopup></SWUpdatePopup></div></div>
    <script src="/assets/js/app.9f76a772.js" defer></script><script src="/assets/js/3.d0406f5b.js" defer></script><script src="/assets/js/15.7be21cdf.js" defer></script><script src="/assets/js/13.ed2af69a.js" defer></script>
  </body>
</html>
